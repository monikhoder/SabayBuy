<!-- Cart Dropdown -->
<div
  id="cartDropdown"
  class="hidden z-50 w-full md:w-md space-y-4 overflow-hidden rounded-md bg-white p-4 antialiased shadow-lg dark:bg-gray-700"
>
  <dl
    class="flex items-center justify-between gap-4 border-b border-gray-200 pb-4 dark:border-gray-700"
  >
    <dt class="font-semibold leading-none text-gray-900 dark:text-white">Your shopping cart</dt>

    <dd class="leading-none text-gray-500 dark:text-gray-400">{{ cartService.cartCount() }} items</dd>
  </dl>

  <!-- Cart item list -->
   @if(cartService.cart()){
      @if (cartService.cart()!.items.length === 0)
        {
          <p class="text-center my-10 text-gray-500 dark:text-gray-400">Your cart is empty</p>
        }
      @else {
        @for (item of cartService.cart()?.items; track $index) {
          
          <div class="grid grid-cols-[1fr_auto_auto] items-center gap-4 py-2">
            
            <div class="flex items-center gap-2 min-w-0"> <a routerLink="/product/{{ item.productId }}" class="flex aspect-square h-9 w-9 shrink-0 items-center">
                <img
                  class="h-auto max-h-full w-full dark:hidden"
                  src="{{item.imageUrl}}"
                  alt="image"
                />
                <img
                  class="hidden h-auto max-h-full w-full dark:block"
                  src="{{item.imageUrl}}"
                  alt="image"
                />
              </a>
              
              <div class="flex-1 min-w-0"> <a
                  routerLink="/product/{{ item.productId }}"
                  class="block truncate text-sm font-semibold leading-tight text-gray-900 hover:underline dark:text-white"
                >
                  {{ item.productName }}
                </a>
                <p class="mt-0.5 truncate text-sm font-normal text-gray-500 dark:text-gray-400">
                  {{ item.productVariantName }}
                </p>
              </div>
            </div>

            <div class="flex items-center justify-end gap-2 whitespace-nowrap">
              <p>x {{ item.quantity }}</p>
              <p class="text-sm font-semibold leading-none text-gray-900 dark:text-white">
                $ {{ (item.price * item.quantity).toFixed(2) }}
              </p>
              <button
                (click)="cartService.removeItemFromCart(item.productId, item.productVariantId)"
                type="button"
                class="text-red-600 hover:text-red-700 dark:text-red-500 dark:hover:text-red-600"
              >
                <span class="sr-only"> Remove </span>
                <svg class="h-4 w-4" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"/>
                </svg>
              </button>
            </div>
          </div>   
        }
      }
    }
 

  <dl class="flex items-center justify-between border-t border-gray-200 pt-4 dark:border-gray-700">
    <dt class="font-semibold leading-none text-gray-900 dark:text-white">Total</dt>

    <dd class="font-semibold leading-none text-gray-900 dark:text-white">$ {{cartService.cartTotal().toFixed(2)}}</dd>
  </dl>

  <button
  type="button"
  routerLink="/cart"
    class="mb-2 mt-4 me-2 inline-flex w-full items-center justify-center rounded-lg bg-primary-700 px-5 py-2.5 text-sm font-medium text-white hover:bg-primary-800 focus:outline-none focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800"
  >
    See your cart
  </button>
</div>
